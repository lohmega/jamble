import sys
sys.path.append('../')
from bblogger import BlueBerryDeserializer


g_chunks = [
    [0x30,0x08,0xdd,0x9c,0x04,0x10,0xa8,0xa9,0x0c,0x18,0xc6,0x02,0x20,0x8a,0xe5,0x05,0x28,0xb2,0x07,0x30],
    [0xea,0xf0,0x02,0x3a,0x06,0xce,0x0b,0x96,0x14,0x8b,0x03,0x42,0x06,0xe7,0x01,0x6c,0xa9,0xfe,0x01,0x4a],
    [0x05,0xb3,0x01,0xbe,0x01,0x69,0x58,0xa2,0x27],
    [0x30,0x08,0xe9,0x9f,0x04,0x10,0xa8,0xa9,0x0c,0x18,0xe2,0x03,0x20,0xd0,0xe5,0x02,0x28,0xc6,0x07,0x30],
    [0x86,0xfa,0x02,0x3a,0x06,0xec,0x0b,0x96,0x14,0xf9,0x02,0x42,0x06,0xe4,0x01,0x06,0x97,0xfe,0x01,0x4a],
    [0x05,0xc9,0x01,0xa4,0x01,0x4d,0x58,0xce,0x26],
    [0x30,0x08,0xea,0x9f,0x04,0x10,0xa6,0xa9,0x0c,0x18,0x92,0x07,0x20,0xf0,0xfb,0x02,0x28,0xc6,0x07,0x30],
    [0x86,0xfa,0x02,0x3a,0x06,0xf0,0x0b,0xdc,0x13,0xe5,0x02,0x42,0x06,0x92,0x02,0x38,0x89,0xff,0x01,0x4a],
    [0x05,0xaf,0x01,0xba,0x01,0x5b,0x58,0x9e,0x26],
    [0x30,0x08,0xeb,0x9f,0x04,0x10,0xaa,0xa9,0x0c,0x18,0xba,0x05,0x20,0xf8,0xf9,0x02,0x28,0xc4,0x07,0x30]
]
usrcb = [
    b'\x84\x02\xae\x01U',
    b"\x18\x08\xb6\x98\x190\xe2\xa3\x03B\x07\xcf'\x807\xb6\x81\x02J\x05",
    b'\x94\x02\xac\x01W',
    b"\x18\x08\xb7\x98\x190\xf2\xa4\x03B\x07\xcd'\xf06\x80\x82\x02J\x05",
    b'\xf8\x01\xba\x01Q',
    b'\x18\x08\xb8\x98\x190\x86\xa4\x03B\x07\x91(\xb47\xfa\x81\x02J\x05',
    b'\x80\x02\xa8\x01;',
    b'\x18\x08\xb9\x98\x190\x86\xa4\x03B\x07\x93(\x807\xca\x82\x02J\x05',
    b'\xf8\x01\xa8\x01Q',
    b'\x18\x08\xba\x98\x190\x86\xa4\x03B\x07\xd1(\xf26\xc6\x82\x02J\x05',
    b'\x80\x02\xb6\x01_',
    b'\x18\x08\xbb\x98\x190\xce\xa4\x03B\x07\x93(\xd07\xda\x81\x02J\x05',
]

peri_cb = [
    b'\x18\x08\xb4\x98\x190\xe2\xa3\x03B\x07\xab(\xf46\x8c\x82\x02J\x05',
    b'\xf8\x01\xaa\x01M',
    b"\x18\x08\xb5\x98\x190\xb8\xa5\x03B\x07\xeb'\xfc6\xe8\x81\x02J\x05",
    b'\x84\x02\xae\x01U',
    b"\x18\x08\xb6\x98\x190\xe2\xa3\x03B\x07\xcf'\x807\xb6\x81\x02J\x05",
    b'\x94\x02\xac\x01W',
    b"\x18\x08\xb7\x98\x190\xf2\xa4\x03B\x07\xcd'\xf06\x80\x82\x02J\x05",
    b'\xf8\x01\xba\x01Q',
    b'\x18\x08\xb8\x98\x190\x86\xa4\x03B\x07\x91(\xb47\xfa\x81\x02J\x05',
    b'\x80\x02\xa8\x01;',
    b'\x18\x08\xb9\x98\x190\x86\xa4\x03B\x07\x93(\x807\xca\x82\x02J\x05',
    b'\xf8\x01\xa8\x01Q',
    b'\x18\x08\xba\x98\x190\x86\xa4\x03B\x07\xd1(\xf26\xc6\x82\x02J\x05',
    b'\x80\x02\xb6\x01_'
]
msg_size=140

def test_success():
    bbld = BlueBerryDeserializer(ofmt='csv')
    for chunk in g_chunks:
        bbld.putb(chunk)

def test_fail():

    bbld = BlueBerryDeserializer(ofmt='csv')
    for b in peri_cb:
        print(bbld.nentries, b)
        bbld.putb(b)

def main():
    test_fail()

main()
